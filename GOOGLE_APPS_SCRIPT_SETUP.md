# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Apps Script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ RUKA

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤

### 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheet

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Sheets](https://sheets.google.com)
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Spreadsheet ‡πÉ‡∏´‡∏°‡πà
3. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ Sheet ‡πÄ‡∏õ‡πá‡∏ô "RUKA Contact Form Submissions"
4. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å ID ‡∏Ç‡∏≠‡∏á Google Sheet ‡∏à‡∏≤‡∏Å URL
   ```
   https://docs.google.com/spreadsheets/d/[SHEET_ID]/edit
   ```

### 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Apps Script

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Apps Script](https://script.google.com)
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "New Project"
3. ‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
4. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå `google-apps-script.js` ‡πÑ‡∏õ‡∏ß‡∏≤‡∏á
5. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `SPREADSHEET_ID` ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô ID ‡∏Ç‡∏≠‡∏á Google Sheet ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
   ```javascript
   const SPREADSHEET_ID = "YOUR_ACTUAL_SHEET_ID_HERE";
   ```

### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Permissions

1. ‡∏Ñ‡∏•‡∏¥‡∏Å "Save" (Ctrl+S)
2. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÄ‡∏õ‡πá‡∏ô "RUKA Contact Form API"
3. ‡∏Ñ‡∏•‡∏¥‡∏Å "Review Permissions" ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡∏≤‡∏°
4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Google Account ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
5. ‡∏Ñ‡∏•‡∏¥‡∏Å "Advanced" ‚Üí "Go to RUKA Contact Form API (unsafe)"
6. ‡∏Ñ‡∏•‡∏¥‡∏Å "Allow"

### 4. Deploy Web App

1. ‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy" ‚Üí "New Deployment"
2. ‡∏Ñ‡∏•‡∏¥‡∏Å gear icon ‚öôÔ∏è ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Web app"
3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
   - **Description**: "RUKA Contact Form API v1.0"
   - **Execute as**: "Me"
   - **Who has access**: "Anyone"
4. ‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy"
5. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å **Web app URL** ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ

### 5. ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï Frontend Code

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå `src/app/contact/page.tsx`:

```typescript
const GOOGLE_SCRIPT_URL = "YOUR_WEB_APP_URL_HERE";
```

‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á Environment Variable:

1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `.env.local`:

   ```
   NEXT_PUBLIC_GOOGLE_SCRIPT_URL=YOUR_WEB_APP_URL_HERE
   ```

2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç code ‡πÄ‡∏õ‡πá‡∏ô:
   ```typescript
   const GOOGLE_SCRIPT_URL = process.env.NEXT_PUBLIC_GOOGLE_SCRIPT_URL;
   ```

### 6. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö

1. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API ‡πÇ‡∏î‡∏¢‡πÑ‡∏õ‡∏ó‡∏µ‡πà Web App URL ‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå
2. ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: "RUKA Contact Form API is working!"
3. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå
4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Google Sheet

## ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ `doOptions` function ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô script
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö CORS headers ‡πÉ‡∏ô response

### ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheet

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö SPREADSHEET_ID ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö permissions ‡∏Ç‡∏≠‡∏á Google Apps Script
- ‡∏î‡∏π execution logs ‡πÉ‡∏ô Google Apps Script

### Frontend Error

- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Web App URL ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ deploy ‡πÅ‡∏•‡πâ‡∏ß
- ‡∏î‡∏π Console errors ‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå

## ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Console Logs

‡∏î‡∏π logs ‡πÉ‡∏ô Google Apps Script:

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Google Apps Script](https://script.google.com)
2. ‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå
3. ‡∏Ñ‡∏•‡∏¥‡∏Å "Executions" ‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢
4. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏π execution logs

## ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï Script

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç script:

1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô Google Apps Script
2. Save (Ctrl+S)
3. Deploy ‡πÉ‡∏´‡∏°‡πà:
   - "Deploy" ‚Üí "Manage Deployments"
   - ‡∏Ñ‡∏•‡∏¥‡∏Å pencil icon ‚úèÔ∏è
   - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "New Version"
   - ‡∏Ñ‡∏•‡∏¥‡∏Å "Deploy"

## ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô Google Sheet

| ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå        | ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á               |
| -------------- | ------------ | ---------------------- |
| ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤    | DateTime     | 25/12/2567, 14:30:00   |
| ‡∏ä‡∏∑‡πà‡∏≠           | Text         | "‡∏™‡∏°‡∏ä‡∏≤‡∏¢"                |
| ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•        | Text         | "‡πÉ‡∏à‡∏î‡∏µ"                 |
| ‡∏≠‡∏µ‡πÄ‡∏°‡∏•          | Email        | "somchai@email.com"    |
| ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå  | Text         | "082-123-4567"         |
| ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£  | Text         | "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ABC ‡∏à‡∏≥‡∏Å‡∏±‡∏î"     |
| ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó | Text         | "‡∏°‡∏µ" ‡∏´‡∏£‡∏∑‡∏≠ "‡πÑ‡∏°‡πà‡∏°‡∏µ"      |
| TAX ID         | Text         | "1234567890123"        |
| ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó  | Text         | "123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó..."   |
| ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ | Text         | "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ä‡πà‡∏≤‡∏á"       |
| ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà  | Emoji        | "üîß"                   |
| ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤     | Text         | "‡∏ä‡∏∏‡∏î‡πÑ‡∏Ç‡∏Ñ‡∏ß‡∏á"             |
| ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤     | Text         | "1,500 ‡∏ö‡∏≤‡∏ó"            |
| ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô          | Number       | "5"                    |
| ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°        | Text         | "‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤..." |

## Security Notes

- Google Apps Script ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ Google Account ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô Google Sheet ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á
- Web App ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô (Anyone) ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö sensitive data ‡πÉ‡∏ô frontend code
